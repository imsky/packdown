/** 
 * Packdown - files in Markdown
 * Version 0.9.9
 * Â© 2020 Ivan Malopinsky
 */
!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(n=n||self).Packdown=e()}(this,function(){"use strict";var u=/^(#{1,6}) \/([a-z0-9.,_()/-]+)$/i,s=/^```([a-z0-9][a-z0-9-]*)?$/i,d="packdown:/";function h(n){return"    "===n.slice(0,4)}return{read:function(n){"\n"!==(n=String(n)).slice(-1)&&(n+="\n");for(var e={},t={files:{},content:[]},r=null,i=null,o=0,a=n.split("\n");o<a.length;o+=1){var f=a[o],l=f.match(u),c=f.match(s);if(l){if(r)throw Error("Unexpected file");r={name:l[2],headingLevel:l[1].length,details:[],infoString:void 0,content:[]},e[(t.files[r.name]=r).name]=!0}else if(r&&c){c=c&&c[1];if(i){if(c||!e[r.name])throw Error("Invalid code block");delete e[r.name],r.content=function(n){var e=!1,t=0;if(1<n.length)for(var r=0;r<n.length;r++){var i=n[r];if(i.length)if(h(i)){if(1<++t){e=!0;break}}else if(0===r){e=!1;break}}else 1===n.length&&h(n[0])&&(e=!0);return e?n.map(function(n){return n.replace(/^ {4}/,"")}):n}(r.content),t.content.push(d+r.name),i=r=null}else r.infoString=c,i=!0}else(r&&!i?r.details:(r&&i?r:t).content).push(f)}if(r||i)throw Error("Truncated input");return t},write:function(n){var e=n.content,o=n.files;if(!e||!o)throw Error("Document content or files missing");if(!Array.isArray(e))throw Error("Document content not an array");if(Object(o)!==o)throw Error("Document files not an object");return e.map(function(n){if(0!==n.indexOf(d))return n;var e=o[n.slice(d.length)],t=e.name,r=e.headingLevel,i=e.details,n=e.infoString;void 0===n&&(n="");e=e.content;return[Array(Math.max(2,r+1)).join("#")+" /"+t,i.join("\n"),"```"+n,e.join("\n"),"```"].join("\n")}).join("\n")},version:"0.9.9"}});
